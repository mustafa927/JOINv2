<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add Task (Overlay)</title>

  <link rel="stylesheet" href="style/boss.css">
  <link rel="stylesheet" href="style/addtask.css">
</head>
<body onload="fetchDataTasks(); assignedToInput();">


    <main>
    

      <div class="maincontent">
  <h1>Add Task</h1>
  <form>
    <div class="form-section">
      <label for="title">Title<span class="required-note"> *</span></label>
      <input type="text" id="title" placeholder="Enter a title" />
      <div id="title-error" class="required-note">
        *This field is required
      </div>

      <label for="desc">Description</label>
      <textarea id="desc" placeholder="Enter a Description"></textarea>

      <label for="due-date">Due date</label>
      <input type="date" id="due-date" />
    </div>
    <div class="line"></div>
    <div class="form-section">
      <label>Priority</label>
      <div class="priority-buttons">
        <button type="button" class="priority-btn urgent">Urgent <img src="svg/urgent.svg" alt="" srcset=""></button>
        <button type="button" class="priority-btn medium">Medium <img src="svg/medium.svg" alt="" srcset=""></button>
        <button type="button" class="priority-btn low">Low <img src="svg/low.svg" alt=""></button>
      </div>
      <label for="assigned">Assigned to</label>
      <div class="assigned-dropdown">
        <div class="assigned-select" onclick="toggleAssignedDropdown()">
          <input
            type="text"
            id="assigned-search"
            class="assigned-search-input"
            placeholder="Select contacts to assign"
            oninput="filterAssignedList()"
          />
          <span class="dropdown-arrow">‚ñº</span>
        </div>
        <div class="assigned-options d-none" id="assigned-list"></div>
      </div>
      <div id="selected-avatars" class="selected-avatars"></div>
      

      
      <label for="category">
        Category<span class="required-note"> *</span>
      </label>

      <select id="category" required>
        <option value="" disabled selected hidden>Bitte Kategorie w√§hlen</option>
        <option value="Technical Task">Technical Task</option>
        <option value="User Story">User Story</option>
      </select>
      
      <div id="category-error" class="required-note">
        *This field is required
      </div>
      
      

      <label for="subtasks">Subtasks</label>
      <div class="subtask-input-container">
        <input type="text" placeholder="Add new subtask" class="subtask-input" />
        <button type="button" class="add-subtask-button" onclick="addSubtask()">+</button>
       

      </div>
      <div id="subtask-list" class="subtask-list"></div>
      
    </div>
  </form>

  <div class="bottom-buttons">
    <button type="reset" class="clear-btn">Clear ‚úó</button>
    <button type="submit" class="create-btn" onclick="createTaskFromFormOverlay()">Create Task ‚úî</button>
  </div>
</div>
</main>

<script>
  // Globale Subtask-Sammlung
let subtasks = [];

function addSubtask() {
const input = document.querySelector('.subtask-input');
const title = input.value.trim();
if (!title) return;

const subtaskId = `sub${subtasks.length + 1}`;
subtasks.push({ id: subtaskId, title, done: false });

renderSubtaskList();
input.value = ""; // üßº Feld leeren
}

function renderSubtaskList() {
const container = document.getElementById('subtask-list');
container.innerHTML = subtasks.map(sub => `
  <div class="subtask-row">
    <span class="checkmark">‚úîÔ∏è</span>
    <span class="subtask-text">${sub.title}</span>
  </div>
`).join('');
}


function toggleSubtaskDone(id) {
const sub = subtasks.find(s => s.id === id);
if (sub) sub.done = !sub.done;
}

</script>
  
  <script src="JavaScript/addTaskOverlay.js" type="module"></script>
  <script type="module" src="JavaScript/addTask.js"></script>
  <script src="JavaScript/fetchAndAddTask.js"></script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Add Task</title>

    <link rel="stylesheet" href="style/sidebar.css">
    <link rel="stylesheet" href="style/addtask.css">
    <link rel="stylesheet" href="style/boss.css">
    <link rel="stylesheet" href="style/dropdown-menu.css">
    <link rel="stylesheet" href="style/help.css">
    <link rel="stylesheet" href="style/header.css">
    <link rel="icon" type="image/x-icon" href="svg/Capa 2.svg">
  </head>
  <body onload="fetchDataTasks(); assignedToInput();">
    <aside class="sidebar">
      <div class="sidebar-logo">
        <img src="svg/sidebarLogo.svg" alt="Join Logo">
      </div>
    
      <nav class="sidebar-nav">
        <a href="summary.html" class="nav-item">
          <img src="svg/Vector.svg" alt="">
          <span>Summary</span>
        </a>
        <a href="#" class="nav-item active">
          <img src="svg/Icons (1).svg" alt="">
          <span>Add Task</span>
        </a>
        <a href="boardsection.html" class="nav-item">
          <img src="svg/Vector (1) 2.svg" alt="">
          <span>Board</span>
        </a>
        <a href="contacts.html" class="nav-item">
          <img src="svg/Icons (2).svg" alt="">
          <span>Contacts</span>
        </a>
      </nav>
    
      <div class="sidebar-footer">
        <a href="privacyPolicy.html">Privacy Policy</a>
        <a href="Legal-notice.html">Legal notice</a>
      </div>
    </aside>


      <main>
        <header class="page-header">
          <div class="logo-title">Kanban Project Management Tool</div>
          <img class="header-logo" src="./svg/Capa 2.svg" alt="">
          <div class="header-icons">
            <div class="help-icon" id="helpIcon">?</div>
            <div class="profile-wrapper">
              <div class="user-initial-small" id="userInitialButton"></div>
              
              <div class="dropdown-menu-small" id="userDropdown">
                  <ul>
                      <li class="mobile-only"><a href="help.html">Help</a></li>
                      <li><a href="Legal-notice.html">Legal Notice</a></li>
                      <li><a href="privacyPolicy.html">Privacy Policy</a></li>
                      <li><a href="Index.html">Log out</a></li>
                  </ul>
              </div>
          </div>
        </header>

        <div class="maincontent">
    <h1>Add Task</h1>
    <form>
      <div class="form-section">
        <label for="title">Title<span class="required-note"> *</span></label>
        <input type="text" id="title" placeholder="Enter a title" />
        <div id="title-error" class="required-note d-none">Title is required</div>


        <label for="desc">Description</label>
        <textarea id="desc" placeholder="Enter a Description"></textarea>

        <label for="due-date">Due date<span class="required-note">*</span></label>
        <input type="date" id="due-date" />
        <div id="date-error" class="required-note d-none">Due date is required</div>
      </div>
      <div class="line"></div>
      <div class="form-section">
        <label>Priority</label>
        <div class="priority-buttons">
          <button type="button" class="priority-btn urgent">&nbsp;Urgent&nbsp; <img src="svg/urgent.svg" alt="" srcset=""></button>
          <button type="button" class="priority-btn medium">Medium <img src="svg/medium.svg" alt="" srcset=""></button>
          <button type="button" class="priority-btn low"> &nbsp;&nbsp;&nbsp;Low&nbsp;&nbsp;&nbsp;  <img src="svg/low.svg" alt=""></button>
        </div>
        <label for="assigned">Assigned to</label>
        <div class="assigned-dropdown">
          <div class="assigned-select" onclick="openAssignedDropdown(event)">
            <input
              type="text"
              id="assigned-search"
              class="assigned-search-input"
              placeholder="Select contacts to assign"
              oninput="filterAssignedList()"
            />
            <span class="dropdown-arrow" onclick="toggleAssignedDropdown(event)">‚ñº</span>
          </div>
          <div class="assigned-options d-none" id="assigned-list"></div>
        </div>
        <div id="selected-avatars" class="selected-avatars"></div>
        

        
        <label for="category">
          Category<span class="required-note"> *</span>
        </label>

        <select id="category" required>
          <option value="" disabled selected hidden>Bitte Kategorie w√§hlen</option>
          <option value="Technical Task">Technical Task</option>
          <option value="User Story">User Story</option>
        </select>
        
        <div id="category-error" class="required-note d-none">Category is required</div>

        
        

        <label for="subtasks">Subtasks</label>
        <div class="subtask-input-container">
          <input type="text" placeholder="Add new subtask" class="subtask-input" />
          <button type="button" class="add-subtask-button" onclick="addSubtask()">+</button>
         

        </div>
        <div id="subtask-list" class="subtask-list"></div>
        
      </div>
    </form>

    <div class="bottom-buttons">
      <div>    <span class="required-note">*</span> This field is required</div>

    <div>
      <button type="button" class="clear-btn" onclick="clearForm()">Clear ‚úó</button>

      <button type="button" class="create-btn" onclick="createTaskFromForm()">Create Task ‚úî</button>
      </div>  
    </div>

  </div>

  </main>

  <script>
    // Globale Subtask-Sammlung
let subtasks = [];

function addSubtask() {
  const input = document.querySelector('.subtask-input');
  const title = input.value.trim();
  if (!title) return;

  const subtaskId = `sub${subtasks.length + 1}`;
  subtasks.push({ id: subtaskId, title, done: false });

  renderSubtaskList();
  input.value = ""; // üßº Feld leeren
}

function renderSubtaskList() {
  const container = document.getElementById('subtask-list');
  container.innerHTML = subtasks.map(sub => `
    <div class="subtask-row">
      <span class="checkmark">‚úîÔ∏è</span>
      <span class="subtask-text">${sub.title}</span>
    </div>
  `).join('');
}


function toggleSubtaskDone(id) {
  const sub = subtasks.find(s => s.id === id);
  if (sub) sub.done = !sub.done;
}

  </script>
<script type="module" src="JavaScript/addTask.js"></script>
<script type="module" src="JavaScript/summary.js"></script>
<script src="JavaScript/navigation.js"></script>
<script src="JavaScript/fetchAndAddTask.js"></script>
<script src="JavaScript/dropdown-menu.js"></script>
<script src="JavaScript/userInitials.js" type="module"></script>
<script src="JavaScript/addTaskAndBoard.js" type="module"></script>
<div id="task-success-message" class="task-success d-none">
  Task added to board <img src="svg/Icons.svg" alt="">
</div>


    
  </body>
</html>